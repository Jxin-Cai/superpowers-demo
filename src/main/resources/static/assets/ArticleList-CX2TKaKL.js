import{o as E,c as $,b as f,i as s,w as l,E as n,h as u,f as x,u as A,a as m,l as o,t as b,j as _,e as k,v as L}from"./index-C9hZSNhL.js";import{a as d}from"./article-BXSlOvJ5.js";import"./index-61r5FlMj.js";const N={style:{"margin-bottom":"20px",display:"flex","justify-content":"space-between"}},H={__name:"ArticleList",setup(S){const v=A(),y=x([]),c=async()=>{try{const e=await d.adminGetAll();y.value=e.data}catch{n.error("加载失败")}},w=e=>{v.push(`/admin/articles/${e}/edit`)},C=async e=>{try{await d.publish(e),n.success("发布成功"),c()}catch{n.error("发布失败")}},g=async e=>{try{await d.unpublish(e),n.success("已取消发布"),c()}catch{n.error("操作失败")}},B=async e=>{try{await L.confirm("确定删除该文章吗？","确认",{type:"warning"}),await d.delete(e),n.success("删除成功"),c()}catch(t){t!=="cancel"&&n.error("删除失败")}};return E(c),(e,t)=>{const r=u("el-button"),i=u("el-table-column"),h=u("el-tag"),D=u("el-table");return m(),$("div",null,[f("div",N,[t[2]||(t[2]=f("h2",null,"文章管理",-1)),s(r,{type:"primary",onClick:t[0]||(t[0]=a=>e.$router.push("/admin/articles/new"))},{default:l(()=>[...t[1]||(t[1]=[o(" 新建文章 ",-1)])]),_:1})]),s(D,{data:y.value,stripe:""},{default:l(()=>[s(i,{prop:"id",label:"ID",width:"80"}),s(i,{prop:"title",label:"标题",width:"200"}),s(i,{prop:"categoryName",label:"分类",width:"150"}),s(i,{prop:"status",label:"状态",width:"100"},{default:l(({row:a})=>[s(h,{type:a.status==="PUBLISHED"?"success":"info"},{default:l(()=>[o(b(a.status==="PUBLISHED"?"已发布":"草稿"),1)]),_:2},1032,["type"])]),_:1}),s(i,{prop:"createdAt",label:"创建时间",width:"180"},{default:l(({row:a})=>[o(b(new Date(a.createdAt).toLocaleString()),1)]),_:1}),s(i,{label:"操作",width:"300"},{default:l(({row:a})=>[s(r,{size:"small",onClick:p=>w(a.id)},{default:l(()=>[...t[3]||(t[3]=[o("编辑",-1)])]),_:1},8,["onClick"]),a.status==="DRAFT"?(m(),_(r,{key:0,size:"small",type:"success",onClick:p=>C(a.id)},{default:l(()=>[...t[4]||(t[4]=[o(" 发布 ",-1)])]),_:1},8,["onClick"])):k("",!0),a.status==="PUBLISHED"?(m(),_(r,{key:1,size:"small",type:"warning",onClick:p=>g(a.id)},{default:l(()=>[...t[5]||(t[5]=[o(" 取消发布 ",-1)])]),_:1},8,["onClick"])):k("",!0),s(r,{size:"small",type:"danger",onClick:p=>B(a.id)},{default:l(()=>[...t[6]||(t[6]=[o("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])}}};export{H as default};
