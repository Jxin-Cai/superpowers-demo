import{_ as x,c as C,d as a,w as r,r as u,u as P,o as R,e as g,b as h,h as m,E as c}from"./index-DiXZHzxD.js";import{u as k}from"./useAuth-CdpwDKnJ.js";import{a as E}from"./index-DQ-5gSyr.js";const U={class:"register-container"},q={__name:"Register",setup(B){const i=P(),{login:_}=k(),p=m(),d=m(!1),l=m({username:"",password:"",confirmPassword:"",email:""}),v={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:50,message:"用户名长度为 3-50 字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码至少 6 字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(n,e,o)=>{e!==l.value.password?o(new Error("两次输入的密码不一致")):o()},trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}]};async function w(){var n,e;await p.value.validate(),d.value=!0;try{await E.post("/auth/register",{username:l.value.username,password:l.value.password,email:l.value.email||null}),_(l.value.username,l.value.password),c.success("注册成功"),i.push("/")}catch(o){c.error(((e=(n=o.response)==null?void 0:n.data)==null?void 0:e.message)||"注册失败")}finally{d.value=!1}}function V(){i.push("/login")}return(n,e)=>{const o=u("el-input"),t=u("el-form-item"),f=u("el-button"),b=u("el-form"),y=u("el-card");return R(),C("div",U,[a(y,{class:"register-card"},{header:r(()=>[...e[4]||(e[4]=[h("h2",null,"CMS 注册",-1)])]),default:r(()=>[a(b,{model:l.value,rules:v,ref_key:"formRef",ref:p,"label-width":"80px"},{default:r(()=>[a(t,{label:"用户名",prop:"username"},{default:r(()=>[a(o,{modelValue:l.value.username,"onUpdate:modelValue":e[0]||(e[0]=s=>l.value.username=s),placeholder:"请输入用户名（3-50字符）"},null,8,["modelValue"])]),_:1}),a(t,{label:"密码",prop:"password"},{default:r(()=>[a(o,{modelValue:l.value.password,"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.password=s),type:"password",placeholder:"请输入密码（至少6字符）"},null,8,["modelValue"])]),_:1}),a(t,{label:"确认密码",prop:"confirmPassword"},{default:r(()=>[a(o,{modelValue:l.value.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=s=>l.value.confirmPassword=s),type:"password",placeholder:"请再次输入密码"},null,8,["modelValue"])]),_:1}),a(t,{label:"邮箱",prop:"email"},{default:r(()=>[a(o,{modelValue:l.value.email,"onUpdate:modelValue":e[3]||(e[3]=s=>l.value.email=s),placeholder:"请输入邮箱（可选）"},null,8,["modelValue"])]),_:1}),a(t,null,{default:r(()=>[a(f,{type:"primary",onClick:w,loading:d.value,style:{width:"100%"}},{default:r(()=>[...e[5]||(e[5]=[g(" 注册 ",-1)])]),_:1},8,["loading"])]),_:1}),a(t,null,{default:r(()=>[a(f,{type:"text",onClick:V},{default:r(()=>[...e[6]||(e[6]=[g("已有账号？去登录",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}},I=x(q,[["__scopeId","data-v-cd94d5ce"]]);export{I as default};
